<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../../css/front-modules.css">
    <script type="text/javascript" src="../../libs/dependencies.js"></script>
    <script type="module" src="../../js/front-dev.js"></script>
    <title>Home | Front Seed</title>
</head>

<body>
    <header class="menu">
        <div class="menu__slash">
            <i class="fas fa-bars"></i>
        </div>
        <div class="menu__logo">
            <figure>
                <img src="http://164.138.209.7/~circuloe/wp-content/uploads/2016/10/logo-circulo-de-economia-provincia-de-alicante-1.png"
                    alt="Logo">
            </figure>
            <p>everis<strong>knowler</strong></p>
        </div>
        <div class="menu__search">
            <form action="">
                <fieldset>
                    <legend class="hide-accessible">Busqueda</legend>
                    <label class="hide-accessible" for="busqueda">Busqueda</label>
                    <input type="text" name="busqueda" id="descriptionbusqueda" placeholder="proyecto skm">
                </fieldset>
            </form>
            <i class="fas fa-search"></i>
        </div>
        <nav class="menu__nav">
            <ul>
                <li>
                    <a href="http://localhost:8000/views/index.html" title="Inicio">
                        <i class="fas fa-home"></i>
                        <p>Inicio</p>
                    </a>
                </li>
                <li>
                    <a href="http://localhost:8000/views/pages/home.html" title="Aplicaciones">
                        <i class="fas fa-th"></i>
                        <p>Aplicaciones</p>
                    </a>
                </li>
                <li>
                    <a href="#" title="Comunidades">
                        <i class="fas fa-globe"></i>
                        <p>Comunidades</p>
                    </a>
                </li>
                <li>
                    <a href="#" title=everPedia>
                        <i class="fas fa-box"></i>
                        <p>everPedia</p>
                    </a>
                </li>
            </ul>
        </nav>
        <div class="menu__profile">
            <a href="#" title="Notificaciones">
                <i class="fas fa-bell"></i>
            </a>
            <a href="#" title="Perfil">
                <figure>
                    <img src="../../assets/images/perfil/perfil@3x.png" alt="Perfil">
                </figure>
                <i class="fas fa-sort-down"></i>
            </a>
        </div>
    </header>
    <main>
        <article class="grid">
            <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                <div class="container">
                    <div class="container__header">
                        <h1><i class="fas fa-filter"></i>Filtros</h1>
                        <a href="#" title="Drop Filtros">
                            <i class="fas fa-ellipsis-v"></i>
                        </a>
                    </div>
                    <div class="container__body container__body_filter">
                        <form action="">
                            <fieldset>
                                <legend class="hide-accessible">Filtros Clientes</legend>
                                <div class="container__element">
                                    <input type="checkbox" name="electrico">
                                    <label for="electrico">Vehículo Eléctrico</label>
                                </div>
                                <div class="container__element">
                                    <label for="puertas"><input type="text" placeholder="Número de puertas"
                                            list="puertas"></label>
                                    <datalist id="puertas">
                                        <option value="3">
                                        <option value="5">
                                    </datalist>
                                </div>
                                <div class="container__element">
                                    <label class="container__radio" for="Todos"><input type="radio" name="tipo"
                                            id="Todos" checked="true">Todos</label>
                                    <label class="container__radio" for="Berlina"><input type="radio" name="tipo"
                                            id="Berlina">Berlina</label>
                                    <label class="container__radio" for="Sedan"><input type="radio" name="tipo"
                                            id="Sedan">Sedán</label>
                                    <label class="container__radio" for="Mono-volumen"><input type="radio" name="tipo"
                                            id="Mono-volumen">Mono-volumen</label>
                                </div>
                            </fieldset>
                            <button type="reset" class="container__button container__button_clear">Clean Filter</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 col-md-4 col-sm-6 col-xs-12">
                <div class="container">
                    <div class="container__header">
                        <h1><i class="fas fa-car"></i>Coches</h1>
                        <a href="#" title="Drop Coches">
                            <i class="fas fa-ellipsis-v"></i>
                        </a>
                    </div>
                    <div class="container__body">
                        <table id="tablaCoche" class="container__table">
                            <tr>
                                <th class="tg-0lax">Cliente</th>
                                <th class="tg-0lax">Marca</th>
                                <th class="tg-0lax">Modelo</th>
                                <th class="tg-0lax">Color</th>
                                <th class="tg-0lax"></th>
                            </tr>
                            <!-- <tr>
                                <td class="tg-0lax"></td>
                                <td class="tg-0lax"></td>
                                <td class="tg-0lax"></td>
                                <td class="tg-0lax">
                                    <div class="container__relleno"></div>
                                </td>
                                <td class="tg-0lax">
                                    <button id="button__update" class="container__button container__button_update">
                                        <p>Actualizar</p>
                                    </button>
                                    <button id="button__delete" class="container__button container__button_delete">
                                        <p>Eliminar</p>
                                    </button>
                                </td>
                            </tr> -->
                        </table>
                        <button id="button__new" class="container__button container__button_clear">Nuevo
                            cliente</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12">
                <div class="container">
                    <div class="container__header">
                        <h1><i class="fas fa-warehouse"></i>Vehiculos en el taller</h1>
                        <a href="#" title="Drop Taller">
                            <i class="fas fa-ellipsis-v"></i>
                        </a>
                    </div>
                    <div class="container__body">
                        <table id="tablaTaller" class="container__table">
                            <!-- <tr>
                                <td class="tg-0lax"></td>
                            </tr> -->
                        </table>
                    </div>
                </div>
                <div class="container">
                    <div class="container__header">
                        <h1><i class="fas fa-hands-helping"></i>Vehiculos entregados</h1>
                        <a href="#" title="Drop Entregados">
                            <i class="fas fa-ellipsis-v"></i>
                        </a>
                    </div>
                    <div class="container__body container__body_entregados">
                        <div id="carousel" class="center">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa1">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa2">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa3">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa4">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa5">
                            <img src="../../assets/images/Carousel/foto.jpg" alt="Costa6">
                        </div>
                    </div>
                </div>
            </div>
        </article>
        <article id="modal-box" class="modal-box">
            <div class="container modal">
                <div class="container__header">
                    <h1><i class="fas fa-file-alt"></i>Crear / Actualizar Cliente</h1>
                    <a href="#" class="modal__close" title="Close Crear / Actualizar Cliente">
                        <i class="fas fa-times"></i>
                    </a>
                </div>
                <div class="container__body modal__body">
                    <form action="" method="post" name="formularioCliente">
                        <fieldset>
                            <legend class="hide-accessible">Cliente</legend>
                            <div class="container__element">
                                <label for="cliente">
                                    Nombre del cliente: <input id="cliente" type="text" placeholder="Cliente">
                                </label>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend class="hide-accessible">Coche</legend>
                            <div class="container__element">
                                <label for="marca">
                                    Marca: <input id="marca" type="text" placeholder="Marca">
                                </label>
                            </div>
                            <div class="container__element">
                                <label for="modelo">
                                    Modelo: <input id="modelo" type="text" placeholder="Modelo">
                                </label>
                            </div>
                            <div class="container__element">
                                <label for="color">
                                    Color del vehiculo: <input id="color" type="color" placeholder="Color">
                                </label>
                            </div>
                            <div class="container__element">
                                <input type="checkbox" name="electrico">
                                <label for="electrico">Vehículo Eléctrico</label>
                            </div>
                            <div class="container__element">
                                <label for="puertas"><input type="text" placeholder="Número de puertas"
                                        list="puertas"></label>
                                <datalist id="puertas">
                                    <option value="3">
                                    <option value="5">
                                </datalist>
                            </div>
                            <div class="container__element">
                                <label class="container__radio" for="Berlina"><input type="radio" name="tipo"
                                        id="Berlina">Berlina</label>
                                <label class="container__radio" for="Sedan"><input type="radio" name="tipo"
                                        id="Sedan">Sedán</label>
                                <label class="container__radio" for="Mono-volumen"><input type="radio" name="tipo"
                                        id="Mono-volumen">Mono-volumen</label>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend class="hide-accessible">Taller</legend>
                            <div class="container__element">
                                <label for="fecha">
                                    Fecha entrada Taller: <input name="fecha" type="date">
                                </label>
                            </div>
                            <div class="container__element">
                                <label for="foto">
                                    Foto del Vehiculo: <input name="foto" type="url">
                                </label>
                            </div>
                        </fieldset>
                        <div class="modal__button">
                            <button type="button" id="enviarCliente"
                                class="container__button container__button_save">Guardar</button>
                            <button type="reset" class="container__button container__button_clear">Borrar</button>
                            <button type="button"
                                class="container__button container__button_delete modal__close">Cancelar</button>
                        </div>
                    </form>
                </div>
            </div>
        </article>
    </main>
</body>

<script type="text/javascript">
    // ----------------------- JSON ----------------------- //
    var xmlhttp = new XMLHttpRequest();

    xmlhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            var dataArray = JSON.parse(xmlhttp.responseText);

            function tablaCoche() {
                let tabla = document.getElementById('tablaCoche');

                for (let item of dataArray) {
                    // let row = tabla.insertRow(-1);

                    // row.id = `cliente` + item.id;

                    // let cell1 = row.insertCell(0);
                    // let cell2 = row.insertCell(1);
                    // let cell3 = row.insertCell(2);
                    // let cell4 = row.insertCell(3);
                    // let cell5 = row.insertCell(4);

                    // cell1.className = "tg-0lax";
                    // cell2.className = "tg-0lax";
                    // cell3.className = "tg-0lax";
                    // cell4.className = "tg-0lax";
                    // cell5.className = "tg-0lax";

                    // cell1.innerHTML = item.cliente;
                    // cell2.innerHTML = item.marca;
                    // cell3.innerHTML = item.modelo;
                    // cell4.innerHTML = `<div style="background-color:#` + item.color +
                    //     `" class="container__relleno"></div>`;
                    // cell5.innerHTML = `<button id="cliente` + item.id + `" class="container__button container__button_update">Actualizar</button>
                    //                 <button id="cliente` + item.id +
                    //     `" class="container__button container__button_delete">Eliminar</button>`;

                    addRow(item, tabla)

                    console.log("ID: " + item.id + " es " + item.cliente);
                };
            };

            function tablaTaller() {
                let tabla = document.getElementById('tablaTaller');

                for (let item of dataArray) {
                    let row = tabla.insertRow(-1);
                    let cell1 = row.insertCell(0);

                    row.id = `cliente` + item.id;

                    cell1.className = "tg-0lax";

                    cell1.innerHTML = `El cliente ` + item.cliente + ` con un ` + item.marca + ` ` + item.modelo +
                        ` entregó el coche en el taller el día ` + item.fechaEntrada + `.`;
                };
            };

            function carouselCoche() {
                let carousel = document.getElementById('carousel');

                for (let item of dataArray) {
                    let img = document.createElement('img');

                    img.src = item.foto;
                    img.alt = "Vehiculo " + item.cliente;

                    carousel.appendChild(img);
                };
            };

            tablaCoche();
            tablaTaller();
            carouselCoche();
        };
    };

    function addRow(item, tabla) {
        let row = tabla.insertRow(-1);

        row.id = `cliente` + item.id;

        let cell1 = row.insertCell(0);
        let cell2 = row.insertCell(1);
        let cell3 = row.insertCell(2);
        let cell4 = row.insertCell(3);
        let cell5 = row.insertCell(4);

        cell1.className = "tg-0lax";
        cell2.className = "tg-0lax";
        cell3.className = "tg-0lax";
        cell4.className = "tg-0lax";
        cell5.className = "tg-0lax";

        cell1.innerHTML = item.cliente;
        cell2.innerHTML = item.marca;
        cell3.innerHTML = item.modelo;
        cell4.innerHTML = `<div style="background-color:#` + item.color +
            `" class="container__relleno"></div>`;
        cell5.innerHTML = `<button id="cliente` + item.id + `" class="container__button container__button_update">Actualizar</button>
                <button id="cliente` + item.id +
            `" class="container__button container__button_delete">Eliminar</button>`;
    }

    function deleteCliente(obj) {
        let select = obj.target;

        if (select.className.includes("button_delete")) {
            // document.getElementById("tablaCoche").deleteRow(select.id);
            // document.getElementById("tablaTaller").deleteRow();

            let row = document.getElementById(select.id);
            row.parentNode.removeChild(row);

            let list = document.getElementById('tablaTaller');
            for (let i = 0; i <= list.rows.length; i++) {
                if (list.rows[i].id == select.id) {
                    list.rows[i].remove();
                };
            };
        };
    };

    document.addEventListener("click", deleteCliente);

    xmlhttp.open("GET", "taller.json");
    xmlhttp.send();

    // ----------------------- Modal crear / actualizar cliente ----------------------- //
    // Get the modal
    var modal = document.getElementById("modal-box");

    // Get the button that opens the modal
    var btn = document.getElementById("button__new");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("modal__close");

    // When the user clicks the button, open the modal 
    btn.onclick = function () {
        modal.style.display = "block";
    };

    // When the user clicks on <span> (x), close the modal
    for (let i = 0; i < span.length; i++) {
        spon = span[i];

        spon.onclick = function () {
            modal.style.display = "none";
        };
    };

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        };
    };

    // ----------------------- Carousel Slick ----------------------- // 
    $(document).ready(function () {
        $('.center').slick({
            centerMode: true,
            centerPadding: '35px',
            slidesToShow: 1,
        });
    });
</script>

</html>